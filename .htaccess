<IfModule mod_rewrite.c>
  RewriteEngine On

  # Proxy ALL requests to Express server on port 3000
  # Express handles: API routes, static files (dist/), and SPA fallback
  RewriteCond %{REQUEST_URI} !^/\.well-known/
  RewriteRule ^(.*)$ http://localhost:3000/$1 [P,L]
</IfModule>

<IfModule mod_proxy.c>
  # Enable proxy modules (required for [P] flag)
  ProxyPreserveHost On
  ProxyPass /.well-known/ !
  ProxyPass / http://localhost:3000/
  ProxyPassReverse / http://localhost:3000/
</IfModule>

# Enable MIME type handling
<IfModule mod_mime.c>
  AddType application/javascript .js .mjs
  AddType text/css .css
  AddType application/json .json
  AddType image/svg+xml .svg
  AddType font/woff .woff
  AddType font/woff2 .woff2
</IfModule>

# Compression (optional but recommended)
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html text/plain text/css application/javascript application/json image/svg+xml
</IfModule>

# Cache control (optional but recommended for production)
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType text/html "access plus 0 seconds"
  ExpiresByType application/javascript "access plus 1 year"
  ExpiresByType text/css "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/svg+xml "access plus 1 year"
  ExpiresByType font/woff "access plus 1 year"
  ExpiresByType font/woff2 "access plus 1 year"
</IfModule>
